@use '@angular/material' as mat;
@use './styles/mixins' as *;
@use './styles/focus' as *;

@import '@fontsource/roboto/300.css';
@import '@fontsource/roboto/400.css';
@import '@fontsource/roboto/500.css';
@import '@fontsource/roboto/700.css';

// Material Icons with font-display: block (intentional for UX)
// Prevents icon flash (FOUT), cached by SW after first load (~125KB)
@import 'material-icons/iconfont/material-icons.css';

html {
  @include mat.theme((
    color: (
      primary: mat.$rose-palette,
      tertiary: mat.$red-palette,
    ),
    typography: (
      brand-family: 'Roboto',
      plain-family: 'Roboto',
    ),
    density: (
      scale: 0,
    )
  ));
  
  --primary-color: #e91e63;
  --accent-color: #ff5722;
  --warn-color: #f44336;
  
  --md-sys-shape-corner-none: 0;
  --md-sys-shape-corner-extra-small: 4px;
  --md-sys-shape-corner-small: 8px;
  --md-sys-shape-corner-medium: 12px;
  --md-sys-shape-corner-large: 16px;
  --md-sys-shape-corner-extra-large: 28px;
  --md-sys-shape-corner-full: 9999px;
  
  --border-radius: var(--md-sys-shape-corner-small);
  --border-radius-lg: var(--md-sys-shape-corner-medium);
  
  --md-sys-motion-duration-short1: 50ms;
  --md-sys-motion-duration-short2: 100ms;
  --md-sys-motion-duration-short3: 150ms;
  --md-sys-motion-duration-short4: 200ms;
  --md-sys-motion-duration-medium1: 250ms;
  --md-sys-motion-duration-medium2: 300ms;
  --md-sys-motion-duration-medium3: 350ms;
  --md-sys-motion-duration-medium4: 400ms;
  --md-sys-motion-duration-long1: 450ms;
  --md-sys-motion-duration-long2: 500ms;
  --md-sys-motion-duration-long3: 550ms;
  --md-sys-motion-duration-long4: 600ms;
  --md-sys-motion-duration-extra-long1: 700ms;
  --md-sys-motion-duration-extra-long2: 800ms;
  --md-sys-motion-duration-extra-long3: 900ms;
  --md-sys-motion-duration-extra-long4: 1000ms;
  
  --md-sys-motion-easing-linear: cubic-bezier(0, 0, 1, 1);
  --md-sys-motion-easing-standard: cubic-bezier(0.4, 0, 0.2, 1);
  --md-sys-motion-easing-standard-decelerate: cubic-bezier(0, 0, 0, 1);
  --md-sys-motion-easing-standard-accelerate: cubic-bezier(0.3, 0, 1, 1);
  --md-sys-motion-easing-emphasized: cubic-bezier(0.2, 0, 0, 1);
  --md-sys-motion-easing-emphasized-decelerate: cubic-bezier(0.05, 0.7, 0.1, 1);
  --md-sys-motion-easing-emphasized-accelerate: cubic-bezier(0.3, 0, 0.8, 0.15);
  
  --md-sys-elevation-level0: none;
  --md-sys-elevation-level1: 0 1px 2px 0 rgba(0, 0, 0, 0.3), 0 1px 3px 1px rgba(0, 0, 0, 0.15);
  --md-sys-elevation-level2: 0 1px 2px 0 rgba(0, 0, 0, 0.3), 0 2px 6px 2px rgba(0, 0, 0, 0.15);
  --md-sys-elevation-level3: 0 1px 3px 0 rgba(0, 0, 0, 0.3), 0 4px 8px 3px rgba(0, 0, 0, 0.15);
  --md-sys-elevation-level4: 0 2px 3px 0 rgba(0, 0, 0, 0.3), 0 6px 10px 4px rgba(0, 0, 0, 0.15);
  --md-sys-elevation-level5: 0 4px 4px 0 rgba(0, 0, 0, 0.3), 0 8px 12px 6px rgba(0, 0, 0, 0.15);
  
  --spacing-unit: 8px;
  --spacing-xs: 4px;
  --spacing-sm: 8px;
  --spacing-md: 16px;
  --spacing-lg: 24px;
  --spacing-xl: 32px;
  --spacing-xxl: 48px;
}

body {
  color-scheme: light;
  background-color: var(--mat-sys-surface);
  color: var(--mat-sys-on-surface);
  font: var(--mat-sys-body-medium);
  margin: 0;
}

.dark-theme {
  --primary-color: #f48fb1;
  --accent-color: #ff8a65;
}

.mat-mdc-elevated-button, 
.mat-mdc-raised-button, 
.mat-mdc-outlined-button,
.mat-mdc-fab,
.mat-mdc-mini-fab {
  border-radius: var(--border-radius) !important;
}

/**
 * Button icon alignment fix for Angular Material v20.2.12
 * 
 * IMPORTANT: This fix uses !important to override internal .mdc-button__label styles.
 * This is a workaround for a known Material Design Components issue where icons
 * and text don't align properly in buttons by default.
 * 
 * WARNING: This relies on internal MDC class structure (.mdc-button__label) which
 * may change in future versions. Review and test after Material upgrades.
 * 
 * Related issue: Angular Material buttons don't properly center icons with text
 */
.mat-mdc-button,
.mat-mdc-raised-button,
.mat-mdc-unelevated-button,
.mat-mdc-outlined-button,
.mat-mdc-flat-button {
  // Icon alignment fix
  .mdc-button__label {
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    gap: 8px !important;
    
    mat-icon {
      display: inline-flex !important;
      align-items: center !important;
      justify-content: center !important;
      margin: 0 !important;
      vertical-align: middle !important;
    }
  }
  
  // For buttons with leading icons
  mat-icon:first-child {
    margin-right: 0 !important;
  }
  
  // For buttons with trailing icons
  mat-icon:last-child {
    margin-left: 0 !important;
  }

  // M3 Button styles - STANDARD HEIGHT 40px
  font-weight: 500 !important;
  letter-spacing: 0.1px !important;
  border-radius: 20px !important; // M3 full rounding for buttons
  height: 40px !important;
  padding: 0 24px !important;
  
  // Clear elevation for raised buttons
  &.mat-mdc-raised-button,
  &.mat-mdc-unelevated-button {
    box-shadow: var(--md-sys-elevation-level1) !important;
    
    &:hover {
      box-shadow: var(--md-sys-elevation-level2) !important;
    }
    
    &:active {
      box-shadow: var(--md-sys-elevation-level1) !important;
    }
  }
  
  // Outlined buttons have distinct borders
  &.mat-mdc-outlined-button {
    border: 1px solid var(--mat-sys-outline) !important;
    border-width: 1px !important;
  }
  
  // Disabled state - M3 opacity standard
  &:disabled,
  &[disabled] {
    opacity: 0.38 !important;
    cursor: not-allowed !important;
    pointer-events: none !important;
  }
  
  // Active/Press state
  &:active:not(:disabled) {
    transform: scale(0.96);
    transition: transform 100ms cubic-bezier(0.2, 0, 0, 1) !important;
  }
}

// Icon button specific fix
.mat-mdc-icon-button {
  mat-icon {
    display: inline-flex !important;
    align-items: center !important;
    justify-content: center !important;
  }
}

/* Material Design 3 Component Overrides */
/* !important is required to override Angular Material's inline and high-specificity styles */
.mat-mdc-card {
  border-radius: var(--border-radius) !important;
}

.mat-mdc-form-field {
  .mdc-text-field {
    border-radius: var(--border-radius) !important;
  }
}

/* M3 Chips - Distinct from buttons */
/* Chips are for displaying selections/filters, not primary actions */
.mat-mdc-chip {
  font-weight: 500 !important;
  letter-spacing: 0.1px !important;
  border: 1px solid currentcolor !important;
  
  // Chips have more padding and rounder corners than buttons
  &.mat-mdc-standard-chip {
    border-radius: 12px !important; // Rounder than buttons
    min-height: 32px !important;
    padding: 0 14px !important;
  }
  
  // Chips are non-interactive by default
  &:not(.mat-mdc-chip-highlighted):not(.mat-mdc-chip-selected) {
    background: color-mix(in srgb, var(--mat-sys-surface-variant) 80%, transparent) !important;
    color: var(--mat-sys-on-surface-variant) !important;
    border-color: color-mix(in srgb, var(--mat-sys-outline) 30%, transparent) !important;
  }
}

/* Material Design 3 Elevation System */
/* !important is required to override Material's default elevation classes */
.mat-elevation-z0 {
  box-shadow: var(--md-sys-elevation-level0) !important;
}

.mat-elevation-z1 {
  box-shadow: var(--md-sys-elevation-level1) !important;
}

.mat-elevation-z2 {
  box-shadow: var(--md-sys-elevation-level2) !important;
}

.mat-elevation-z3 {
  box-shadow: var(--md-sys-elevation-level3) !important;
}

.mat-elevation-z4 {
  box-shadow: var(--md-sys-elevation-level4) !important;
}

.mat-elevation-z5 {
  box-shadow: var(--md-sys-elevation-level5) !important;
}

html, body { 
  height: 100%; 
  margin: 0; 
  font-family: 'Roboto', "Helvetica Neue", sans-serif;
}

.text-primary { color: var(--primary-color) !important; }
.text-accent { color: var(--accent-color) !important; }
.text-warn { color: var(--warn-color) !important; }

.bg-primary { background-color: var(--primary-color) !important; }
.bg-accent { background-color: var(--accent-color) !important; }

.p-xs { padding: var(--spacing-xs) !important; }
.p-sm { padding: var(--spacing-sm) !important; }
.p-md { padding: var(--spacing-md) !important; }
.p-lg { padding: var(--spacing-lg) !important; }
.p-xl { padding: var(--spacing-xl) !important; }

.m-xs { margin: var(--spacing-xs) !important; }
.m-sm { margin: var(--spacing-sm) !important; }
.m-md { margin: var(--spacing-md) !important; }
.m-lg { margin: var(--spacing-lg) !important; }
.m-xl { margin: var(--spacing-xl) !important; }

.flex-center {
  display: flex;
  justify-content: center;
  align-items: center;
}

.flex-between {
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.flex-column {
  display: flex;
  flex-direction: column;
}

.display-large {
  font-family: 'Roboto', sans-serif;
  font-size: 3.5rem;
  font-weight: 400;
  line-height: 1.14;
  letter-spacing: -0.02em;
}

.display-medium {
  font-family: 'Roboto', sans-serif;
  font-size: 2.8rem;
  font-weight: 400;
  line-height: 1.16;
  letter-spacing: 0;
}

.display-small {
  font-family: 'Roboto', sans-serif;
  font-size: 2.25rem;
  font-weight: 400;
  line-height: 1.22;
  letter-spacing: 0;
}

.headline-large {
  font-family: 'Roboto', sans-serif;
  font-size: 2rem;
  font-weight: 400;
  line-height: 1.25;
  letter-spacing: 0;
}

.headline-medium {
  font-family: 'Roboto', sans-serif;
  font-size: 1.75rem;
  font-weight: 400;
  line-height: 1.29;
  letter-spacing: 0;
}

.headline-small {
  font-family: 'Roboto', sans-serif;
  font-size: 1.5rem;
  font-weight: 400;
  line-height: 1.33;
  letter-spacing: 0;
}

.body-large {
  font-family: 'Roboto', sans-serif;
  font-size: 1rem;
  font-weight: 400;
  line-height: 1.5;
  letter-spacing: 0.03em;
}

.body-medium {
  font-family: 'Roboto', sans-serif;
  font-size: 0.875rem;
  font-weight: 400;
  line-height: 1.43;
  letter-spacing: 0.018em;
}

.body-small {
  font-family: 'Roboto', sans-serif;
  font-size: 0.75rem;
  font-weight: 400;
  line-height: 1.33;
  letter-spacing: 0.033em;
}

.label-large {
  font-family: 'Roboto', sans-serif;
  font-size: 0.875rem;
  font-weight: 500;
  line-height: 1.43;
  letter-spacing: 0.018em;
}

.label-medium {
  font-family: 'Roboto', sans-serif;
  font-size: 0.75rem;
  font-weight: 500;
  line-height: 1.33;
  letter-spacing: 0.033em;
}

.label-small {
  font-family: 'Roboto', sans-serif;
  font-size: 0.688rem;
  font-weight: 500;
  line-height: 1.45;
  letter-spacing: 0.036em;
}

.fade-in {
  animation: fadeIn 0.3s ease-in-out;
}

@keyframes fadeIn {
  from { opacity: 0; transform: translateY(10px); }
  to { opacity: 1; transform: translateY(0); }
}

/* M3 Touch Targets - Minimum 48x48px on Mobile */
@media (max-width: 768px) {
  .mat-mdc-button,
  .mat-mdc-raised-button,
  .mat-mdc-unelevated-button,
  .mat-mdc-outlined-button,
  .mat-mdc-flat-button {
    min-height: 48px !important;
    height: 48px !important;
  }
  
  .mat-mdc-icon-button {
    width: 48px !important;
    height: 48px !important;
  }
  
  // Ensure clickable areas
  button,
  a:not(p a),
  [role="button"],
  .clickable {
    min-height: 48px;
    min-width: 48px;
  }
}

/* MatSnackBar custom styles for notification types */
.snackbar-error {
  --mdc-snackbar-container-color: #d32f2f !important;
  --mdc-snackbar-supporting-text-color: white !important;
  --mat-snack-bar-button-color: white !important;
}

.snackbar-success {
  --mdc-snackbar-container-color: #388e3c !important;
  --mdc-snackbar-supporting-text-color: white !important;
  --mat-snack-bar-button-color: white !important;
}

.snackbar-warning {
  --mdc-snackbar-container-color: #f57c00 !important;
  --mdc-snackbar-supporting-text-color: white !important;
  --mat-snack-bar-button-color: white !important;
}

.snackbar-info {
  --mdc-snackbar-container-color: #1976d2 !important;
  --mdc-snackbar-supporting-text-color: white !important;
  --mat-snack-bar-button-color: white !important;
}
